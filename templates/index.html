<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ZOF - Zero of Function Solver</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  </head>
  <body class="bg-light">
    <div class="container py-4">
      <h1 class="mb-3">ZOF — Zero of Function Solver</h1>
      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          {% for cat, msg in messages %}
            <div class="alert alert-{{cat}}">{{ msg }}</div>
          {% endfor %}
        {% endif %}
      {% endwith %}

      <form method="post" class="card p-3 mb-4">
        <div class="row g-2">
          <div class="col-md-4">
            <label class="form-label">Method</label>
            <select name="method" id="method" class="form-select" onchange="toggleFields()">
              {% for key, meta in methods.items() %}
                <option value="{{key}}" {% if form.method==key %}selected{% endif %}>{{meta.name}}</option>
              {% endfor %}
            </select>
          </div>

          <div class="col-md-8">
            <label class="form-label">Function f(x)</label>
            <input name="f" class="form-control" placeholder="Example: x**3 - 2*x - 5" value="{{ form.f or '' }}" required>
            <div class="form-text">Use Python-style expressions. You can use math functions like sin(x), exp(x) — prefix not needed.</div>
          </div>

          <div class="col-md-6" id="df_field">
            <label class="form-label">Derivative f'(x) (optional, for Newton)</label>
            <input name="df" class="form-control" placeholder="Example: 3*x**2 - 2" value="{{ form.df or '' }}">
          </div>

          <div class="col-md-6" id="g_field">
            <label class="form-label">g(x) for Fixed Point (if using Fixed Point)</label>
            <input name="g" class="form-control" placeholder="Example: (x**3 - 5)/2" value="{{ form.g or '' }}">
          </div>

          <div class="col-md-3">
            <label class="form-label">a (left endpoint)</label>
            <input name="a" class="form-control" value="{{ form.a or '' }}">
          </div>
          <div class="col-md-3">
            <label class="form-label">b (right endpoint)</label>
            <input name="b" class="form-control" value="{{ form.b or '' }}">
          </div>

          <div class="col-md-3">
            <label class="form-label">x0</label>
            <input name="x0" class="form-control" value="{{ form.x0 or '' }}">
          </div>
          <div class="col-md-3">
            <label class="form-label">x1</label>
            <input name="x1" class="form-control" value="{{ form.x1 or '' }}">
          </div>

          <div class="col-md-3">
            <label class="form-label">delta (modified secant)</label>
            <input name="delta" class="form-control" value="{{ form.delta or '0.001' }}">
          </div>

          <div class="col-md-3">
            <label class="form-label">Tolerance</label>
            <input name="tol" class="form-control" value="{{ form.tol or '1e-6' }}">
          </div>

          <div class="col-md-3">
            <label class="form-label">Max Iterations</label>
            <input name="maxiter" class="form-control" value="{{ form.maxiter or '50' }}">
          </div>

        </div>

        <div class="mt-3">
          <button class="btn btn-primary">Compute</button>
          <button type="reset" class="btn btn-outline-secondary">Reset</button>
        </div>
      </form>

      {% if result %}
        <div class="card p-3 mb-4">
          <h4>Result</h4>
          <p><strong>Estimated root:</strong> {{ result.root }}</p>
          <p><strong>Converged:</strong> {{ result.converged }}</p>
          <p><strong>Iterations:</strong> {{ result.iterations }}</p>
        </div>
      {% endif %}

    </div>

    <script>
      function toggleFields(){
        // simple dynamic hinting - nothing complex
      }
      // call once
      toggleFields();
    </script>
  </body>
</html>
